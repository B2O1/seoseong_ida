<!DOCTYPE html>
<html>
    <head>
        <title>메뉴로 찾기</title>
        <link rel="stylesheet" href="../css/menu.css">
        <link rel="stylesheet" href="../css/home.css">
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const popup = document.getElementById('searchSuggestions');
                const searchInput = document.querySelector('.search-bar');
                const searchForm = document.getElementById('searchForm'); // 검색 폼 추가
        
                // 선택된 값 저장 변수
                let selectedValues = {
                  coffee: '',
                  beverage: '',
                  dessert: '',
                };
        
                // 팝업 열기
                function showSuggestions() {
                  if (popup) {
                    popup.classList.remove('hidden');
                    popup.style.display = 'block';
                  }
                }
        
                // 팝업 닫기 (선택된 버튼 초기화 X)
                function hideSuggestions() {
                  if (popup) {
                    popup.classList.add('hidden');
                    popup.style.display = 'none';
                  }
                }
        
                // 검색창 클릭 시 팝업 열기
                if (searchInput) {
                  searchInput.addEventListener('click', function (event) {
                    event.stopPropagation();
                    showSuggestions();
                  });
                }
        
                // 팝업 바깥을 클릭했을 때 닫기
                document.addEventListener('click', function (event) {
                  if (!popup.contains(event.target) && event.target !== searchInput) {
                    hideSuggestions();
                  }
                });
        
                // 팝업 내부 클릭 시 닫히지 않도록 방지
                if (popup) {
                  popup.addEventListener('click', function (event) {
                    event.stopPropagation();
                  });
                }
        
                // 모든 카테고리에서 하나의 버튼만 선택 가능하도록 설정
                const categories = {
                  container_coffee: 'coffee',
                  container_beverage: 'beverage',
                  container_dessert: 'special',
                };
        
                Object.keys(categories).forEach((categoryId) => {
                  const category = document.getElementById(categoryId);
                  if (category) {
                    category.addEventListener('click', function (event) {
                      if (event.target.classList.contains('tag-btn')) {
                        event.stopPropagation();
        
                        // 같은 카테고리의 버튼에서 'selected' 클래스 제거
                        category.querySelectorAll('.tag-btn').forEach((btn) => btn.classList.remove('selected'));
        
                        // 클릭한 버튼만 'selected' 클래스 추가
                        event.target.classList.add('selected');
        
                        // 선택된 값 저장
                        selectedValues[categories[categoryId]] = event.target.innerText.trim();
                      }
                    });
                  }
                });
        
                // 검색 입력창에서 엔터를 누르거나 검색 버튼을 클릭하면 search.html로 값 전달
                if (searchForm) {
                  searchForm.addEventListener('submit', function (event) {
                    event.preventDefault(); // 기본 동작 막기
        
                    // 검색어 값 가져오기
                    const searchQuery = searchInput.value.trim();
                    console.log('🔍 검색어 입력 값:', searchQuery);
        
                    // URL 생성 (검색어 + 선택된 버튼 값)
                    const queryParams = new URLSearchParams();
                    if (searchQuery) queryParams.append('query', searchQuery);
                    if (selectedValues.who) queryParams.append('who', selectedValues.who);
                    if (selectedValues.what) queryParams.append('what', selectedValues.what);
                    if (selectedValues.special) queryParams.append('special', selectedValues.special);
        
                    const finalURL = 'search.html?' + queryParams.toString();
                    console.log('이동할 URL: ', finalURL);
        
                    // 현재 창에서 열기
                    window.top.location.href = finalURL;
                  });
                }
              });
            </script>
        <style>
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }
        </style>
    </head>
    <body>
        <object class="header" data="header.html"></object>
        <section class = 'middle'>
            <div class = 'menu-search-bar'>
                <i class = 'fas fa-search'></i>
                <input class = 'menu-search-bar__input' type = 'search' placeholder = '입맛 다시는 중.....' />
            </div>
        </section>
        <section class = 'main-bar'>
            <div class = 'main-bar-title'> COFFEE
            </div>
            <div class = 'main-bar-title'> BEVERAGE
            </div>
            <div class = 'main-bar-title'> DESSERT
            </div>
            <div class = 'main-bar__input'>
                <input type = 'radio' id = 'group1-btn1' name = 'group1'>
                <label for = 'group1-btn1'> 카라멜 마끼아또 </label>
                </button>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group1-btn2' name = 'group1'>
                <label for = 'group1-btn2'> 아인슈페너 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group1-btn3' name = 'group1'>
                <label for = 'group1-btn3'> 카푸치노 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group1-btn4' name = 'group1'>
                <label for = 'group1-btn4'> 카라멜 마끼아또 </label>
            </div>
            <div class = 'main-bar__input'>
                <input type = 'radio' id = 'group2-btn1' name = 'group2'>
                <label for = 'group2-btn1'> 사과티 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group2-btn2' name = 'group2'>
                <label for = 'group2-btn2'> 복숭아 라떼 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group2-btn3' name = 'group2'>
                <label for = 'group2-btn3'> 블루베리 스무디 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group2-btn2' name = 'group2'>
                <label for = 'group2-btn1'> 딸기라떼 </label>
            </div>
            <div class = 'main-bar__input'>
                <input type = 'radio' id = 'group3-btn1' name = 'group3'>
                <label for = 'group3-btn1'> 마카롱 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group3-btn2' name = 'group3'>
                <label for = 'group3-btn2'> 에그타르트 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group3-btn3' name = 'group3'>
                <label for = 'group3-btn3'> 몽블랑 </label>
                <br />
                <br />
                <br />
                <input type = 'radio' id = 'group3-btn2' name = 'group3'>
                <label for = 'group3-btn1'> 수플레 </label>
            </div>
        </section>
    </body>
</html>
