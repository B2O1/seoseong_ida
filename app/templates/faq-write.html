{% extends "reference.html" %}
{% load static %}

{% block activate %}
<div class="faq-container">
  <h1 class="faq-title mb-4">문의 작성</h1>

  <form method="post" class="faq-form">
    {% csrf_token %}
    {{ form.non_field_errors }}

    {# ✅ 로그인 상태: name/email 입력칸 감추고, 고정 안내만 표시 #}
    {% if request.user.is_authenticated %}
      <div class="faq-field">
        <label>작성자</label>
        <div style="padding:10px 12px;border:1px solid #ddd;border-radius:8px;background:#fafafa">
          {{ request.session.display_name|default:request.user.username }} ({{ request.user.email }})
        </div>
      </div>
      {# 서버에서 HiddenInput으로 바꿔뒀으므로 별도 렌더 불필요 #}
    {% else %}
      {# 비로그인: 기존처럼 name/email 입력받기 #}
      <div class="faq-field">
        {{ form.name.label_tag }}
        {{ form.name }}
        {{ form.name.errors }}
      </div>
      <div class="faq-field">
        {{ form.email.label_tag }}
        {{ form.email }}
        {{ form.email.errors }}
      </div>
    {% endif %}

    <div class="faq-field">
      {{ form.question.label_tag }}
      {{ form.question }}
      {{ form.question.errors }}
    </div>

    <div class="faq-actions">
      <button class="faq-btn faq-primary" type="submit">등록</button>
      <a href="{% url 'faq_list' %}" class="faq-btn">취소</a>
    </div>
  </form>
</div>
{% endblock %}

{% block script %}
<style>
  .faq-form{display:flex;flex-direction:column;gap:16px;}
  .faq-field label{display:block;font-weight:600;margin-bottom:6px;}
  input,textarea{width:100%;border:1px solid #ddd;border-radius:8px;padding:10px;font-size:1rem;}
</style>
{% endblock %}